<!-- chat.component.html -->
<div class="chat-container">
  <!-- Lista delle conversazioni per il possessore dell'asta -->
  @if(isPrivate && (whoAmI == auctionOwner)){
    <div class="conversations-list">
      @for(conversation of conversations; track conversation){
      <div (click)="selectConversation(conversation)" [ngClass]="{'selected': conversation === selectedConversation}">
        {{ conversation.name }}
      </div>
      }
    </div>
  }

  <!-- Messaggi della conversazione selezionata -->
  <div class="message-list">
    @if(selectedConversation){
      <!-- Itera sui messaggi della conversazione selezionata -->
      @for(message of selectedConversation.messages ; track message){
        <div class="message" [ngClass]="{'sent': message.author === whoAmI, 'received': message.author !== whoAmI}" [id]="message.id">
          <div class="message-author">{{ message.author }}</div>
          <div class="message-content">
            <!-- Visualizza il messaggio a cui si sta rispondendo -->
            @if (message.replyTo){
            <div class="reply-preview" (click)="scrollToMessage(message.replyTo?.id)">
              <div class="reply-author">{{ message.replyTo?.author }}</div>
              <div class="reply-content">{{ message.replyTo?.content }}</div>
            </div>
            }
            {{ message.content }}
          </div>
          <button class="reply-button" (click)="replyToMessage(message)">Reply</button>
        </div>
      }
    }

  </div>

  <!-- Sezione di risposta -->
  @if(replyToMessageData){
    <div class="reply-preview">
      <div class="reply-content">
        Replying to {{ replyToMessageData?.author }}: {{ replyToMessageData?.content }}
      </div>
      <button class="cancel-reply-button" (click)="cancelReply()">Cancel</button>
    </div>
  }

  <!-- Input del messaggio -->
  <div class="message-input">
    <input [(ngModel)]="newMessage" placeholder="Type a message..." />
    <button (click)="sendMessage(replyToMessageData?.id)">Send</button>
  </div>
</div>
